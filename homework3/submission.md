# Magic 8 Ball

## Problem

We are given the following declaration of a multidimensional array:
```
char magic8ball[8][8][8];
```

Using gdb, we find that the base address of the array is `0x7fffffffe000`:
```
(gdb) p &magic8ball
$1 = (char (*)[8][8][8]) 0x7fffffffe000
```

```
(gdb) x/512bx 0x7fffffffe000
0x7fffffffe000: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe008: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe010: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe018: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe020: 0x59 0x65 0x73 0x00 0x00 0x00 0x00 0x00
0x7fffffffe028: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe030: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe038: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe040: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe048: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe050: 0x52 0x69 0x67 0x68 0x74 0x00 0x00 0x00
0x7fffffffe058: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe060: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe068: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe070: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe078: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe080: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe088: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe090: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe098: 0x59 0x65 0x73 0x00 0x00 0x00 0x00 0x00
0x7fffffffe0a0: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe0a8: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe0b0: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe0b8: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe0c0: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe0c8: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe0d0: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe0d8: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe0e0: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe0e8: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe0f0: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe0f8: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe100: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe108: 0x52 0x69 0x67 0x68 0x74 0x00 0x00 0x00
0x7fffffffe110: 0x53 0x75 0x72 0x65 0x00 0x00 0x00 0x00
0x7fffffffe118: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe120: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe128: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe130: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe138: 0x52 0x69 0x67 0x68 0x74 0x00 0x00 0x00
0x7fffffffe140: 0x59 0x65 0x73 0x00 0x00 0x00 0x00 0x00
0x7fffffffe148: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe150: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe158: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe160: 0x59 0x65 0x61 0x68 0x00 0x00 0x00 0x00
0x7fffffffe168: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe170: 0x52 0x69 0x67 0x68 0x74 0x00 0x00 0x00
0x7fffffffe178: 0x4e 0x6f 0x00 0xff 0xff 0x7f 0x00 0x00
0x7fffffffe180: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe188: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe190: 0x59 0x65 0x73 0x00 0x00 0x00 0x00 0x00
0x7fffffffe198: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe1a0: 0x4e 0x61 0x68 0x00 0x00 0x00 0x00 0x00
0x7fffffffe1a8: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe1b0: 0x53 0x75 0x72 0x65 0x00 0x00 0x00 0x00
0x7fffffffe1b8: 0x59 0x65 0x73 0x00 0x00 0x00 0x00 0x00
0x7fffffffe1c0: 0x53 0x75 0x72 0x65 0x00 0x00 0x00 0x00
0x7fffffffe1c8: 0x53 0x75 0x72 0x65 0x00 0x00 0x00 0x00
0x7fffffffe1d0: 0x4e 0x65 0x76 0x65 0x72 0x00 0x00 0x00
0x7fffffffe1d8: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
0x7fffffffe1e0: 0x4d 0x61 0x79 0x62 0x65 0x00 0x00 0x00
0x7fffffffe1e8: 0x57 0x72 0x6f 0x6e 0x67 0x00 0x00 0x00
0x7fffffffe1f0: 0x53 0x75 0x72 0x65 0x00 0x00 0x00 0x00
0x7fffffffe1f8: 0x4c 0x69 0x6b 0x65 0x6c 0x79 0x00 0x00
```

## Question

What would be returned from the statement `printf("%s", magic8ball[3][4]);`?

## Solution

- `magic8ball[3][4]` is an array of 8 chars

1. Calculate the base address of `magic8ball[3][4]` *relative to the base address of `magic8ball`

$$\left( 8 \cdot 8 \cdot 3 \right) + \left( 8 \cdot 4 \right) = 224$$

2. Add the calculated offset to the base address of `magic8ball` to get the absolute address of `magic8ball[3][4]`

    - convert the offset to hex: $224_{10} \rightarrow \text{e0}_{16}$
    - perform the addition: $\text{0x7fffffffe000} + \text{e0} = \text{0x7fffffffe0e0}$

3. Collect the 8 chars in the array and convert them to letters using ASCII

char | letter
---- | ------
0x57 | W
0x72 | r
0x6f | o
0x6e | n
0x67 | g
0x00 | NULL
0x00 | NULL
0x00 | NULL

**In conclusion, the base address of `magic8ball[3][4]` is 0x7fffffffe0e0 and the word that is spells is "Wrong".**
